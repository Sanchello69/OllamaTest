# RTF to Vector Embeddings with Ollama + RAG

–ö–æ–Ω—Å–æ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Kotlin –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ RTF —Ñ–∞–π–ª–æ–≤, —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —á–∞–Ω–∫–æ–≤ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Ollama. –í–∫–ª—é—á–∞–µ—Ç RAG (Retrieval-Augmented Generation) –∞–≥–µ–Ω—Ç–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º OpenRouter API.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ RTF —Ñ–∞–π–ª–æ–≤
- ‚úÖ –†–∞–∑–±–∏–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ —á–∞–Ω–∫–∏ **–ø–æ –∞–±–∑–∞—Ü–∞–º** (—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ)
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ —á–µ—Ä–µ–∑ Ollama API
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ (JSON —Ñ–æ—Ä–º–∞—Ç, —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Å FAISS)
- ‚úÖ –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–æ –∏–Ω–¥–µ–∫—Å—É
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–Ω–¥–µ–∫—Å–∞
- ‚úÖ **RAG-–∞–≥–µ–Ω—Ç**: –≤–æ–ø—Ä–æ—Å—ã —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- ‚úÖ **AI Assistant**: —Ä–µ–∂–∏–º—ã —Å RAG –∏ –±–µ–∑ RAG —á–µ—Ä–µ–∑ OpenRouter API

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 1. Java Development Kit (JDK) 17 –∏–ª–∏ –≤—ã—à–µ

```bash
java -version
```

### 2. Ollama

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Ollama –∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –º–æ–¥–µ–ª—å –¥–ª—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Ollama (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
# macOS/Linux:
curl -fsSL https://ollama.com/install.sh | sh

# –ó–∞–ø—É—Å–∫ Ollama
ollama serve

# –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ: –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
ollama pull nomic-embed-text
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Ollama —Ä–∞–±–æ—Ç–∞–µ—Ç:
```bash
curl http://localhost:11434/api/tags
```

### 3. OpenRouter API (–¥–ª—è RAG-–∞–≥–µ–Ω—Ç–∞)

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è RAG-–∞–≥–µ–Ω—Ç–∞ –Ω—É–∂–µ–Ω API –∫–ª—é—á –æ—Ç OpenRouter:

1. **–ü–æ–ª—É—á–∏—Ç–µ API –∫–ª—é—á** –Ω–∞ [OpenRouter](https://openrouter.ai/)
2. **–°–æ–∑–¥–∞–π—Ç–µ `local.properties`** –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:
   ```bash
   cp local.properties.example local.properties
   ```
3. **–î–æ–±–∞–≤—å—Ç–µ –≤–∞—à –∫–ª—é—á** –≤ `local.properties`:
   ```properties
   OPENROUTER_API_KEY=your-api-key-here
   ```

**–í–∞–∂–Ω–æ:**
- ‚úÖ `local.properties` —É–∂–µ –≤ `.gitignore` - –∫–ª—é—á –Ω–µ –ø–æ–ø–∞–¥–µ—Ç –≤ git
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–æ–¥–µ–ª—å `nex-agi/deepseek-v3.1-nex-n1:free` (–±–µ—Å–ø–ª–∞—Ç–Ω–∞—è)
- ‚úÖ –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `local.properties.example` –∫–∞–∫ —à–∞–±–ª–æ–Ω

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —Å–±–æ—Ä–∫–∞

### –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd OllamaTest

# –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
./gradlew build

# –°–æ–∑–¥–∞–Ω–∏–µ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ JAR —Ñ–∞–π–ª–∞
./gradlew jar
```

–ò–ª–∏ –Ω–∞ Windows:
```cmd
gradlew.bat build
gradlew.bat jar
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è RTF —Ñ–∞–π–ª–∞

–û–±—Ä–∞–±–æ—Ç–∞—Ç—å RTF —Ñ–∞–π–ª –∏ —Å–æ–∑–¥–∞—Ç—å –∏–Ω–¥–µ–∫—Å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤:

```bash
./gradlew run --args="index document.rtf"
```

–° –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:

```bash
./gradlew run --args="index document.rtf my_index.json 2000 50"
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `document.rtf` - –ø—É—Ç—å –∫ RTF —Ñ–∞–π–ª—É
- `my_index.json` - –ø—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω–¥–µ–∫—Å–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: embeddings_index.json)
- `2000` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞ –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö –∞–±–∑–∞—Ü–µ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 2000)
- `50` - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞ (—Ñ–∏–ª—å—Ç—Ä –∫–æ—Ä–æ—Ç–∫–∏—Ö –∞–±–∑–∞—Ü–µ–≤, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 50)

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –¢–µ–∫—Å—Ç —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –ø–æ –∞–±–∑–∞—Ü–∞–º, –∞ –Ω–µ –ø–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å–∏–º–≤–æ–ª–æ–≤. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫—É—é —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å —á–∞–Ω–∫–æ–≤.

### 2. –ü–æ–∏—Å–∫ –ø–æ –∏–Ω–¥–µ–∫—Å—É

–í—ã–ø–æ–ª–Ω–∏—Ç—å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–æ —Å–æ–∑–¥–∞–Ω–Ω–æ–º—É –∏–Ω–¥–µ–∫—Å—É:

```bash
./gradlew run --args="search my_index.json '–≤–∞—à –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å'"
```

–° —É–∫–∞–∑–∞–Ω–∏–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:

```bash
./gradlew run --args="search my_index.json '–º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ' 10"
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `my_index.json` - –ø—É—Ç—å –∫ –∏–Ω–¥–µ–∫—Å—É
- `'–≤–∞—à –∑–∞–ø—Ä–æ—Å'` - –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
- `10` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–ø —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 5)

### 3. RAG-–∞–≥–µ–Ω—Ç: –í–æ–ø—Ä–æ—Å—ã —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º

**–° RAG (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)** - –ø–æ–∏—Å–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —á–∞–Ω–∫–æ–≤ + –æ—Ç–≤–µ—Ç –æ—Ç LLM:

```bash
./gradlew run --args="ask '–ö–∞–∫ –∑–≤–∞–ª–∏ —Å—Ç–µ–ø–Ω–æ–≥–æ –≤–æ–ª–∫–∞?'"
```

**–ë–µ–∑ RAG** - –ø—Ä—è–º–æ–π –≤–æ–ø—Ä–æ—Å –∫ LLM –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:

```bash
./gradlew run --args="ask '–ß—Ç–æ —Ç–∞–∫–æ–µ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ?' --no-rag"
```

–° —É–∫–∞–∑–∞–Ω–∏–µ–º –∏–Ω–¥–µ–∫—Å–∞:

```bash
./gradlew run --args="ask '–ö—Ç–æ –≥–ª–∞–≤–Ω—ã–π –≥–µ—Ä–æ–π?' my_index.json"
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `'–≤–∞—à –≤–æ–ø—Ä–æ—Å'` - –≤–æ–ø—Ä–æ—Å –∫ AI-–∞–≥–µ–Ω—Ç—É
- `my_index.json` - –ø—É—Ç—å –∫ –∏–Ω–¥–µ–∫—Å—É (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: embeddings_index.json)
- `--no-rag` - –æ—Ç–∫–ª—é—á–∏—Ç—å RAG —Ä–µ–∂–∏–º (–±–µ–∑ –ø–æ–∏—Å–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞)

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç RAG —Ä–µ–∂–∏–º:**
1. üîç –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —ç–º–±–µ–¥–¥–∏–Ω–≥ –¥–ª—è –≤–æ–ø—Ä–æ—Å–∞
2. üìö –ò—â–µ—Ç 5 –Ω–∞–∏–±–æ–ª–µ–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —á–∞–Ω–∫–æ–≤ –≤ –∏–Ω–¥–µ–∫—Å–µ
3. ü§ñ –û–±—ä–µ–¥–∏–Ω—è–µ—Ç —á–∞–Ω–∫–∏ —Å –≤–æ–ø—Ä–æ—Å–æ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ LLM (DeepSeek V3.1 —á–µ—Ä–µ–∑ OpenRouter)
4. üí¨ –ü–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞

**–†–µ–∂–∏–º –±–µ–∑ RAG:**
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤–æ–ø—Ä–æ—Å –Ω–∞–ø—Ä—è–º—É—é –≤ LLM –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –ü–æ–ª–µ–∑–µ–Ω –¥–ª—è –æ–±—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤, –Ω–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏

### 4. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–Ω–¥–µ–∫—Å–∞

–ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∏–Ω–¥–µ–∫—Å–µ:

```bash
./gradlew run --args="stats my_index.json"
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ JAR —Ñ–∞–π–ª–∞

–ü–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å JAR —Ñ–∞–π–ª –Ω–∞–ø—Ä—è–º—É—é:

```bash
# –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è
java -jar build/libs/OllamaTest-1.0-SNAPSHOT.jar index document.rtf

# –ü–æ–∏—Å–∫
java -jar build/libs/OllamaTest-1.0-SNAPSHOT.jar search embeddings_index.json "–ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å"

# RAG-–∞–≥–µ–Ω—Ç
java -jar build/libs/OllamaTest-1.0-SNAPSHOT.jar ask "–ö–∞–∫ –∑–≤–∞–ª–∏ —Å—Ç–µ–ø–Ω–æ–≥–æ –≤–æ–ª–∫–∞?"
java -jar build/libs/OllamaTest-1.0-SNAPSHOT.jar ask "–ß—Ç–æ —Ç–∞–∫–æ–µ ML?" --no-rag

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
java -jar build/libs/OllamaTest-1.0-SNAPSHOT.jar stats embeddings_index.json
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ë–∞–∑–æ–≤–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è

```bash
# –°–æ–∑–¥–∞—Ç—å –∏–Ω–¥–µ–∫—Å –∏–∑ RTF —Ñ–∞–π–ª–∞
./gradlew run --args="index documents/report.rtf"

# –ü–æ–∏—Å–∫ –≤ –∏–Ω–¥–µ–∫—Å–µ
./gradlew run --args="search embeddings_index.json '–∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö'"
```

### –ü—Ä–∏–º–µ—Ä 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —á–∞–Ω–∫–∏–Ω–≥–∞

```bash
# –ë–æ–ª—å—à–∏–µ —á–∞–Ω–∫–∏ —Å –±–æ–ª—å—à–∏–º –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ–º –¥–ª—è –ª—É—á—à–µ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
./gradlew run --args="index documents/book.rtf book_index.json 1000 100"

# –ú–∞–ª—ã–µ —á–∞–Ω–∫–∏ –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞
./gradlew run --args="index documents/article.rtf article_index.json 200 20"
```

### –ü—Ä–∏–º–µ—Ä 3: –†–∞–±–æ—Ç–∞ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏

```bash
# –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è —Ä–∞–∑–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
./gradlew run --args="index doc1.rtf index1.json"
./gradlew run --args="index doc2.rtf index2.json"

# –ü–æ–∏—Å–∫ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –∏–Ω–¥–µ–∫—Å–µ
./gradlew run --args="search index1.json '—Ç–µ–º–∞ 1'"
./gradlew run --args="search index2.json '—Ç–µ–º–∞ 2'"
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
OllamaTest/
‚îú‚îÄ‚îÄ build.gradle.kts          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏ Gradle
‚îú‚îÄ‚îÄ settings.gradle.kts       # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ README.md                 # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îî‚îÄ‚îÄ src/main/kotlin/
    ‚îú‚îÄ‚îÄ Main.kt              # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å CLI
    ‚îú‚îÄ‚îÄ RtfParser.kt         # –ü–∞—Ä—Å–µ—Ä RTF —Ñ–∞–π–ª–æ–≤
    ‚îú‚îÄ‚îÄ TextChunker.kt       # –†–∞–∑–±–∏–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ —á–∞–Ω–∫–∏
    ‚îú‚îÄ‚îÄ OllamaClient.kt      # –ö–ª–∏–µ–Ω—Ç –¥–ª—è Ollama API
    ‚îî‚îÄ‚îÄ VectorIndex.kt       # –í–µ–∫—Ç–æ—Ä–Ω—ã–π –∏–Ω–¥–µ–∫—Å —Å –ø–æ–∏—Å–∫–æ–º
```

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### RtfParser
–ü–∞—Ä—Å–∏—Ç RTF —Ñ–∞–π–ª—ã –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç —á–∏—Å—Ç—ã–π —Ç–µ–∫—Å—Ç, –∏—Å–ø–æ–ª—å–∑—É—è –±–∏–±–ª–∏–æ—Ç–µ–∫—É rtfparserkit.

### TextChunker
–†–∞–∑–±–∏–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç –Ω–∞ —á–∞–Ω–∫–∏ —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º —Ä–∞–∑–º–µ—Ä–æ–º –∏ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ–º. –ü—ã—Ç–∞–µ—Ç—Å—è —Ä–∞–∑–±–∏–≤–∞—Ç—å –ø–æ –≥—Ä–∞–Ω–∏—Ü–∞–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –¥–ª—è –ª—É—á—à–µ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞.

### OllamaClient
HTTP –∫–ª–∏–µ–Ω—Ç –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å Ollama API. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–º.

### VectorIndex
–í–µ–∫—Ç–æ—Ä–Ω—ã–π –∏–Ω–¥–µ–∫—Å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –ø–æ–∏—Å–∫–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞.

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å FAISS

–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ—Å—Ç–æ–π JSON —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω–¥–µ–∫—Å–∞. –î–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å FAISS:

### –®–∞–≥–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ FAISS:

1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ FAISS**
   ```bash
   # macOS
   brew install faiss

   # Ubuntu/Debian
   apt-get install libfaiss-dev
   ```

2. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ FAISS Java bindings**

   –û–±–Ω–æ–≤–∏—Ç–µ `build.gradle.kts`:
   ```kotlin
   dependencies {
       // –î–æ–±–∞–≤—å—Ç–µ FAISS bindings
       implementation("com.github.facebookresearch.faiss:faiss-java:1.7.4")
   }
   ```

3. **–ó–∞–º–µ–Ω–∞ VectorIndex –Ω–∞ FAISS**

   –ó–∞–º–µ–Ω–∏—Ç–µ –º–µ—Ç–æ–¥—ã –≤ `VectorIndex.kt` –Ω–∞ –≤—ã–∑–æ–≤—ã FAISS API:
   ```kotlin
   import swigfaiss.*

   val index = IndexFlatIP(dimension)  // Inner Product index
   index.add(embeddings)               // –î–æ–±–∞–≤–∏—Ç—å –≤–µ–∫—Ç–æ—Ä—ã
   index.search(query, k)              // –ü–æ–∏—Å–∫
   faiss.write_index(index, filename)  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
   ```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ FAISS:
- üöÄ –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±—ã—Å—Ç—Ä–µ–µ –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ (>10K –≤–µ–∫—Ç–æ—Ä–æ–≤)
- üìä –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ (ANN)
- üíæ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
- üéØ GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–¥–µ–ª–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `nomic-embed-text` (384 –∏–∑–º–µ—Ä–µ–Ω–∏—è). –í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ –º–æ–¥–µ–ª–∏:

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–æ–¥–µ–ª–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –≤ Ollama:

```bash
# nomic-embed-text (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) - 384 –∏–∑–º–µ—Ä–µ–Ω–∏—è
ollama pull nomic-embed-text

# mxbai-embed-large - 1024 –∏–∑–º–µ—Ä–µ–Ω–∏—è
ollama pull mxbai-embed-large

# all-minilm - 384 –∏–∑–º–µ—Ä–µ–Ω–∏—è
ollama pull all-minilm
```

–î–ª—è —Å–º–µ–Ω—ã –º–æ–¥–µ–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –≤ `OllamaClient.kt`:
```kotlin
class OllamaClient(
    private val baseUrl: String = "http://localhost:11434",
    private val model: String = "mxbai-embed-large"  // –ò–∑–º–µ–Ω–∏—Ç–µ –∑–¥–µ—Å—å
)
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### Ollama –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –∑–∞–ø—É—â–µ–Ω –ª–∏ Ollama
curl http://localhost:11434/api/tags

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Ollama
killall ollama
ollama serve
```

### –û—à–∏–±–∫–∞ "model not found"

```bash
# –ó–∞–≥—Ä—É–∑–∏—Ç–µ –º–æ–¥–µ–ª—å
ollama pull nomic-embed-text

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –º–æ–¥–µ–ª–∏
ollama list
```

### OutOfMemoryError –ø—Ä–∏ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–∞—Ö

–£–≤–µ–ª–∏—á—å—Ç–µ –ø–∞–º—è—Ç—å JVM:
```bash
java -Xmx4G -jar build/libs/OllamaTest-1.0-SNAPSHOT.jar index large_file.rtf
```

–ò–ª–∏ —É–º–µ–Ω—å—à–∏—Ç–µ —Ä–∞–∑–º–µ—Ä —á–∞–Ω–∫–æ–≤:
```bash
./gradlew run --args="index large_file.rtf index.json 200 20"
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–ø—Ä–∏–º–µ—Ä–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è):

- –ü–∞—Ä—Å–∏–Ω–≥ RTF: ~0.1s –Ω–∞ 1000 —Å—Ç—Ä–∞–Ω–∏—Ü
- –ß–∞–Ω–∫–∏–Ω–≥: ~0.01s –Ω–∞ 10K —Å–∏–º–≤–æ–ª–æ–≤
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤: ~0.1-0.5s –Ω–∞ —á–∞–Ω–∫ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –º–æ–¥–µ–ª–∏)
- –ü–æ–∏—Å–∫: ~0.001s –Ω–∞ –∑–∞–ø—Ä–æ—Å (–¥–æ 10K –≤–µ–∫—Ç–æ—Ä–æ–≤)

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:

1. **–î–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤**: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª—å—à–∏–µ —á–∞–Ω–∫–∏ (1000+ —Å–∏–º–≤–æ–ª–æ–≤)
2. **–î–ª—è —Ç–æ—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞**: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∞–ª—ã–µ —á–∞–Ω–∫–∏ (200-300 —Å–∏–º–≤–æ–ª–æ–≤)
3. **–î–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**: –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ FAISS –¥–ª—è –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ >10K –≤–µ–∫—Ç–æ—Ä–æ–≤

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## –ê–≤—Ç–æ—Ä

–°–æ–∑–¥–∞–Ω–æ —Å –ø–æ–º–æ—â—å—é Claude Code
